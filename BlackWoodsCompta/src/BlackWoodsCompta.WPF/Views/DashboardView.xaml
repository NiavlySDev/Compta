<UserControl x:Class="BlackWoodsCompta.WPF.Views.DashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:helpers="clr-namespace:BlackWoodsCompta.WPF.Helpers"
             Background="#1E1E1E">
    
    <UserControl.Resources>
        <helpers:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </UserControl.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Margin="0,0,0,20">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="ðŸ“Š" FontSize="32" VerticalAlignment="Center"/>
                <TextBlock Text="Tableau de Bord" 
                          FontSize="28" 
                          FontWeight="Bold"
                          Foreground="White"
                          VerticalAlignment="Center"
                          Margin="10,0"/>
            </StackPanel>
            
            <Button Command="{Binding RefreshCommand}"
                   Content="ðŸ”„ Actualiser"
                   HorizontalAlignment="Right"
                   Background="#673AB7"
                   Foreground="White"
                   BorderThickness="0"
                   Padding="15,8"
                   Cursor="Hand"
                   FontSize="14"/>
        </Grid>

        <!-- KPI Cards -->
        <Grid Grid.Row="1" Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Revenue Card -->
            <Border Grid.Column="0" Margin="0,0,10,0" Padding="20" Background="#2D2D30" CornerRadius="4" BorderBrush="#3E3E42" BorderThickness="1">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="ðŸ“ˆ" FontSize="24" VerticalAlignment="Center"/>
                        <TextBlock Text="Revenus" 
                                  FontSize="14" 
                                  Foreground="#AAA"
                                  Margin="10,0"
                                  VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock FontSize="32" FontWeight="Bold" Foreground="#4CAF50">
                        <Run Text="$"/>
                        <Run Text="{Binding TotalRevenue, StringFormat=N2}"/>
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- Expenses Card -->
            <Border Grid.Column="1" Margin="0,0,10,0" Padding="20" Background="#2D2D30" CornerRadius="4" BorderBrush="#3E3E42" BorderThickness="1">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="ðŸ“‰" FontSize="24" VerticalAlignment="Center"/>
                        <TextBlock Text="DÃ©penses" 
                                  FontSize="14" 
                                  Foreground="#AAA"
                                  Margin="10,0"
                                  VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock FontSize="32" FontWeight="Bold" Foreground="#FF6B6B">
                        <Run Text="$"/>
                        <Run Text="{Binding TotalExpenses, StringFormat=N2}"/>
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- Profit Card -->
            <Border Grid.Column="2" Margin="0,0,10,0" Padding="20" Background="#2D2D30" CornerRadius="4" BorderBrush="#3E3E42" BorderThickness="1">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="ðŸ’°" FontSize="24" VerticalAlignment="Center"/>
                        <TextBlock Text="BÃ©nÃ©fice Net" 
                                  FontSize="14" 
                                  Foreground="#AAA"
                                  Margin="10,0"
                                  VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock FontSize="32" FontWeight="Bold" Foreground="#2196F3">
                        <Run Text="$"/>
                        <Run Text="{Binding NetProfit, StringFormat=N2}"/>
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- Transactions Card -->
            <Border Grid.Column="3" Padding="20" Background="#2D2D30" CornerRadius="4" BorderBrush="#3E3E42" BorderThickness="1">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="ðŸ§¾" FontSize="24" VerticalAlignment="Center"/>
                        <TextBlock Text="Transactions" 
                                  FontSize="14" 
                                  Foreground="#AAA"
                                  Margin="10,0"
                                  VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock Text="{Binding TransactionCount}" 
                              FontSize="32" 
                              FontWeight="Bold" 
                              Foreground="#9C27B0"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Quick Stats -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Chart Area (Placeholder) -->
            <Border Grid.Column="0" Margin="0,0,10,0" Padding="20" Background="#2D2D30" CornerRadius="4" BorderBrush="#3E3E42" BorderThickness="1">
                <StackPanel>
                    <TextBlock Text="Ã‰volution Mensuelle" 
                              FontSize="18" 
                              FontWeight="SemiBold"
                              Foreground="White"
                              Margin="0,0,0,20"/>
                    <TextBlock Text="[Graphique Ã  implÃ©menter avec LiveCharts]" 
                              FontSize="14"
                              Foreground="#AAA"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              Margin="0,100,0,0"/>
                </StackPanel>
            </Border>

            <!-- Quick Info -->
            <Border Grid.Column="1" Padding="20" Background="#2D2D30" CornerRadius="4" BorderBrush="#3E3E42" BorderThickness="1">
                <StackPanel>
                    <TextBlock Text="Informations Rapides" 
                              FontSize="18" 
                              FontWeight="SemiBold"
                              Foreground="White"
                              Margin="0,0,0,20"/>

                    <!-- Employees -->
                    <Border BorderBrush="#3E3E42" 
                           BorderThickness="0,0,0,1" 
                           Padding="0,10">
                        <Grid>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ‘¥" 
                                          FontSize="20"
                                          VerticalAlignment="Center"/>
                                <TextBlock Text="EmployÃ©s" 
                                          Foreground="White"
                                          Margin="10,0"
                                          VerticalAlignment="Center"/>
                            </StackPanel>
                            <TextBlock Text="{Binding EmployeeCount}" 
                                      FontWeight="Bold"
                                      Foreground="White"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Right"/>
                        </Grid>
                    </Border>

                    <!-- Low Stock -->
                    <Border BorderBrush="#3E3E42" 
                           BorderThickness="0,0,0,1" 
                           Padding="0,10">
                        <Grid>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="âš ï¸" 
                                          FontSize="20"
                                          VerticalAlignment="Center"/>
                                <TextBlock Text="Stock Bas" 
                                          Foreground="White"
                                          Margin="10,0"
                                          VerticalAlignment="Center"/>
                            </StackPanel>
                            <TextBlock Text="{Binding LowStockItemsCount}" 
                                      FontWeight="Bold"
                                      Foreground="#FF9800"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Right"/>
                        </Grid>
                    </Border>

                    <!-- Pending Invoices -->
                    <Border Padding="0,10">
                        <Grid>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ“„" 
                                          FontSize="20"
                                          VerticalAlignment="Center"/>
                                <TextBlock Text="Factures en attente" 
                                          Foreground="White"
                                          Margin="10,0"
                                          VerticalAlignment="Center"/>
                            </StackPanel>
                            <TextBlock Text="{Binding PendingInvoicesCount}" 
                                      FontWeight="Bold"
                                      Foreground="#2196F3"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Right"/>
                        </Grid>
                    </Border>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Loading Overlay -->
        <Grid Grid.RowSpan="3" 
              Background="#80000000" 
              Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Border Width="100" Height="100" Background="#2D2D30" CornerRadius="4">
                <TextBlock Text="â³" FontSize="48" HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
        </Grid>
    </Grid>
</UserControl>
